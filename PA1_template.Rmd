---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
data <- read.csv("C:\\Users\\rmbhagat\\Desktop\\Coursera\\R\\Exercises\\5_ReproducibleReports\\RepData_PeerAssessment1\\activity\\activity.csv")
```


## What is mean total number of steps taken per day?
```{r dailytotalsteps}
data2 <- tapply(data$steps, data$date, sum)
```
```{r histogram}
par(mar=c(5,4,1,1))
hist(data2)
```
```{r, results="hide"}
data2mean <- mean(data2, na.rm=TRUE)
data2median <- median(data2, na.rm=TRUE)
```
The mean number of steps per day is `r data2mean`.
The median number of steps per day is `r data2median`.

## What is the average daily activity pattern?
```{r}
dataAve5Int <- tapply(data$steps, data$interval, mean, na.rm=TRUE)
plot(names(dataAve5Int),dataAve5Int,type="l")
```
```{r, results="hide"}
nameIntervalMaxAve <- names(dataAve5Int[dataAve5Int==max(dataAve5Int)])
```
5-minute interval, on average across all the days in the dataset, which contains the maximum number of steps is `r nameIntervalMaxAve`


## Imputing missing values
```{r, results="hide"}
totalNAs <- sum(is.na(data$steps))
```
Total number of missing values is `r totalNAs`

```{r, results="hide"}
dataCopy <- data
library(plyr)
impute.mean <- function(x) replace(x, is.na(x), mean(x, na.rm = TRUE))
ddply(dataCopy, .(as.character(date)), transform, steps = impute.mean(steps))
```

```{r dailytotalsteps2}
dataCopy2 <- tapply(dataCopy$steps, dataCopy$date, sum)
```
```{r histogram2}
par(mar=c(5,4,1,1))
hist(dataCopy2)
```
```{r, results="hide"}
dataCopy2mean <- mean(dataCopy2, na.rm=TRUE)
dataCopy2median <- median(dataCopy2, na.rm=TRUE)
```

The mean total number of steps taken per day is `r dataCopy2mean`. <br/>
The median total number of steps taken per day is `r dataCopy2median`.


## Are there differences in activity patterns between weekdays and weekends?
